<!--
    screen_sponsors.html
    by Rob McGuire-Dale, 9/3/2009

    This screen displays a list of sponsors and friends. 
-->

<style>
    /* required css class for auto scroller tool */
    .screen_sponsors_scrollable_items {
        height:   20000em;
        position: absolute;
        clear:    both;
    }
</style>

<script type="text/javascript">
    var screen_sponsors_friend_count = 0;
    var screen_sponsors_sponsor_count = 0;
    
    /////////////////////
    // event functions //
    /////////////////////
    
    function screen_sponsors_init() {
        safelog('screen_sponsors: initializing...');

        // initialize tiles
        screen_sponsors_initTiles();
    }

    function screen_sponsors_start() {
        safelog('screen_sponsors: starting...');

        // re-position tiles
        screen_sponsors_positionTiles();
    }

    function screen_sponsors_stop() {
        safelog('screen_sponsors: stopping');
    }

    function screen_sponsors_onScreenResize() {
        safelog('screen_sponsors: window was resized');
        
        // re-position tiles
        screen_sponsors_positionTiles();
    }

    //////////////////////////
    // tile setup functions //
    //////////////////////////

    function screen_sponsors_initTiles(){
        // position and size the tiles. The aggregate functions rely
        // on tile sizes.
        screen_sponsors_positionTiles();
        
        // fill the tiles with aggregated data.
        screen_sponsors_aggregateFriends();
        
        // setup scrollers for the friends and sponsors tiles.
        screen_sponsors_setupScrollers();
    }

    function screen_sponsors_setupScrollers(){            

        // setup friends scrollers
        $(".screen_sponsors_friends").scrollable({ 
            vertical:true,
            speed:1000,
            loop:true,
            size: screen_sponsors_friend_count,    // page size
        });
        $(".screen_sponsors_friends").autoscroll({
            interval:5000,  // time to show each item.
            autopause:true, // pause on mouseover?
            autoplay:true,  // begin playing immediately?
        });
        $(".screen_sponsors_friends").circular();
        
        // setup sponsors scrollers
        $(".screen_sponsors_sponsors").scrollable({ 
            vertical:true,
            items:".screen_sponsors_scrollable_items",
            speed:2000,
            loop:true,
            size: 5,    // page size
        });
        $(".screen_sponsors_sponsors").autoscroll({
            interval:10000,  // time to show each item.
            autopause:true, // pause on mouseover?
            autoplay:true,  // begin playing immediately?
        });
        $(".screen_sponsors_sponsors").circular();
    }
    
    function screen_sponsors_positionTiles(){
        
        // set the width of the bottom tiles per the settings
        $('.screen_sponsors_sponsors').width(
            {{settings.screen_sponsors_screen_sponsors.sponsors_max_width}});
        $('.screen_sponsors_friends').width(
            {{settings.screen_sponsors_screen_sponsors.friends_width}});
        
        // if the total tile width is too large to fit in the window,
        // resize the sponsors tile dynamically
        if( $('.screen_sponsors_friends').outerWidth( true ) + 
            $('.screen_sponsors_sponsors').outerWidth( true ) > 
            screenWidth() ){
                
            $('.screen_sponsors_sponsors').width( screenWidth() -
                $('.screen_sponsors_friends').outerWidth( true ) -
                ( $('.screen_sponsors_sponsors').outerWidth( true ) -
                $('.screen_sponsors_sponsors').width() ) );
        }
        
        // position the bottom tiles
        $('.screen_sponsors_friends').css('top',
            $('.screen_sponsors_title').outerHeight( true ) );
        $('.screen_sponsors_friends').css('left', 0 );
        $('.screen_sponsors_sponsors').css('top',
            $('.screen_sponsors_title').outerHeight( true ) );
        $('.screen_sponsors_sponsors').css('left',
            $('.screen_sponsors_friends').outerWidth( true ) );
        
        // set the height of the bottom tiles
        $('.screen_sponsors_sponsors').height( screenHeight() -
            $('.screen_sponsors_title').outerHeight(true) -
            $('.screen_sponsors_sponsors').outerHeight(true) +
            $('.screen_sponsors_sponsors').height());
        $('.screen_sponsors_friends').height( screenHeight() -
            $('.screen_sponsors_title').outerHeight(true) -
            $('.screen_sponsors_friends').outerHeight(true) +
            $('.screen_sponsors_friends').height());
        
        // size the title width to match the width of the bottom tiles
        $('.screen_sponsors_title').width( 
            $('.screen_sponsors_friends').outerWidth( true ) + 
            $('.screen_sponsors_sponsors').outerWidth( true ) -
            ( $('.screen_sponsors_title').outerWidth( true ) -
            $('.screen_sponsors_title').width() ) );
            
        // center the tiles
        $('.screen_sponsors_title').css( 'left', screenWidth()/2 - 
            $('.screen_sponsors_title').outerWidth( true )/2 );
        $('.screen_sponsors_friends').css( 'left', 
            parseInt( $('.screen_sponsors_title').css( 'left' ) ) );
        $('.screen_sponsors_sponsors').css( 'left', 
            parseInt( $('.screen_sponsors_title').css( 'left' ) ) +
            $('.screen_sponsors_friends').outerWidth( true ) );
    }
    
    ///////////////////////////
    // aggregation functions //
    ///////////////////////////

    function screen_sponsors_aggregateFriends(){
        
        // number of friends aggregated
        screen_sponsors_friend_count = 0;
        
        // number of friends that can fit on one tile page
        var friendsPerPage = 0; 
        
        // number of times the friends list is repeated
        var repeatCount = 0;
        
        // clear the friends list
        $(".screen_sponsors_friends").children().html("");
        
        // if friends list doesn't completely fill the tile, repeat 
        // friends list until it does
        do{
            
            // TEMPORARY TEST aggregation
            for( var ii = 0; ii < 10; ii++ ){
                
                $(".screen_sponsors_friends").children().append(
                    "<p class='screen_sponsors_friends_item'>" + 
                    ii +"</p>"
                );
                
                screen_sponsors_friend_count++;
            }
            
            // get the number of friends that can fit on one tile page.
            // Must be calulated after at least one friend is 
            // aggregated since it relys on friends list size.
            friendsPerPage = Math.floor( 
                $(".screen_sponsors_friends").height() /
                $(".screen_sponsors_friends_item").outerHeight( true ) );

            // increment the number of times the list is repeated
            repeatCount++;
            
        } while( screen_sponsors_friend_count <= friendsPerPage )
        
        safelog( "screen_sponsors: Friends list repeated " +
            repeatCount + " times." );
    }
    
    function screen_sponsors_aggregateSponsors(){
        
        // number of sponsors aggregated
        screen_sponsors_sponsor_count = 0;
        
        // number of sponsors that can fit on one tile page
        var sponsorsPerPage = 0; 
        
        // number of times the sponsors list is repeated
        var repeatCount = 0;
        
        // clear the sponsors list
        $(".screen_sponsors_sponsors").children().html("");
        
        // if sponsors list doesn't completely fill the tile, repeat 
        // sponsors list until it does
        do{
            
            // TEMPORARY TEST aggregation
            for( var ii = 0; ii < 10; ii++ ){
                
                $(".screen_sponsors_friends").children().append(
                    "<p class='screen_sponsors_friends_item'>" + 
                    ii +"</p>"
                );
                
                screen_sponsors_friend_count++;
            }
            
            // get the number of sponsors that can fit on one tile page.
            // Must be calulated after at least one friend is 
            // aggregated since it relys on friends list size.
            friendsPerPage = Math.floor( 
                $(".screen_sponsors_friends").height() /
                $(".screen_sponsors_friends_item").outerHeight( true ) );

            // increment the number of times the list is repeated
            repeatCount++;
            
        } while( screen_sponsors_sponsors_count <= sponsorsPerPage )
        
        safelog( "screen_sponsors: Friends list repeated " +
            repeatCount + " times." );
    }
</script>

<div class="display_tile display_title screen_sponsors_title">
    Sponsors
</div>

<div class="screen_sponsors_friends display_tile display_content">
    <div class='screen_sponsors_scrollable_items'>
        <!-- This will be auto-filled by the downloaded friends -->
    </div>
</div>

<div class="screen_sponsors_sponsors display_tile display_content">
    <img src="{{SITE_ROOT}}/static/screen_sponsors/horiz-gradient.png">
    <div class='screen_sponsors_scrollable_items'>
        <div>
            <h1>Lorem</h1>
            <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer id lacus vehicula ante suscipit porttitor. Ut ullamcorper condimentum lobortis. Duis elit libero, posuere congue sagittis consectetur, laoreet consequat purus. Nullam ut nibh tellus. In hac habitasse platea dictumst. Etiam rhoncus mattis eros, sit amet iaculis tellus commodo at. In sit amet neque erat. Donec mollis diam dapibus tortor venenatis in volutpat sem ullamcorper.
            </p>
            <p>
            Aliquam eros diam, dictum non euismod ac, porttitor quis nunc. Vivamus a nulla vel tortor adipiscing lobortis nec et velit. Fusce id porta ipsum. Morbi libero dolor, pharetra at tempor facilisis, porttitor ac velit. Nunc vestibulum varius posuere. Nulla eu pellentesque augue. Aenean ligula odio, luctus ac tincidunt nec, luctus eget nibh. Pellentesque posuere dui quis urna egestas suscipit. In ligula neque, posuere ac adipiscing a, congue in arcu. 
            </p>
        </div>
        
        <div>
            <h1>Integer</h1>
            <p>
            Integer pretium dolor id enim convallis ac euismod odio auctor. Proin quis mi lectus. Nunc ut pulvinar est. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Curabitur ornare feugiat tortor vel sollicitudin. Vestibulum ut turpis odio, non ultrices diam. Integer est metus, iaculis ornare tristique eu, viverra in enim.
            </p>
            <p>
            Mauris semper commodo consectetur. Praesent pharetra diam nec arcu pretium vitae pretium augue consequat. Duis semper dolor vestibulum ipsum rutrum eget tristique leo scelerisque. Mauris odio ipsum, feugiat sit amet mollis et, varius id velit. Integer malesuada adipiscing urna, eget laoreet erat rutrum tincidunt. 
            </p>
        </div>
        
        <div>
            <h1>Duis</h1>
            <p>
            Duis porttitor diam eget eros suscipit mattis eu ac purus. Etiam ac nibh nisl, at porttitor lacus. Donec ornare mi at sapien scelerisque eleifend. Nam commodo justo sed augue dignissim ut imperdiet turpis convallis. Proin consectetur ultricies leo, at imperdiet nisl semper id. In a purus massa. Fusce eu lorem eu tortor fermentum volutpat. Nam vel nibh imperdiet urna egestas placerat non at quam. Donec nulla leo, congue vitae accumsan eget, fermentum vel turpis. Ut sit amet leo dolor. Sed vestibulum, nulla a tristique tristique, velit lacus scelerisque eros, vitae scelerisque massa dui a nisi. In neque felis, rutrum in varius ullamcorper, ultricies ut mi.
            </p>
            <p>
            Donec elit elit, aliquet ut euismod id, sollicitudin sed odio. Maecenas id risus arcu, non suscipit enim. Vestibulum at nibh consequat sapien egestas semper. Pellentesque ornare, massa tempor placerat condimentum, libero ante mollis augue, eget vehicula justo felis quis metus. Integer pulvinar lacinia luctus. Praesent odio arcu, feugiat eget commodo ut, gravida non felis. Proin eget odio quam. Mauris ut nisi dolor, ac gravida nulla. 
            </p>
        </div>
        
        <div>
            <h1>Sed</h1>
            <p>
            Sed ut elit eu velit hendrerit adipiscing. Duis dapibus ornare porttitor. Duis suscipit commodo sapien vitae mattis. Donec consectetur scelerisque augue, et porttitor mauris sollicitudin vel. Cras pretium pellentesque enim quis porttitor. Sed condimentum, urna in dignissim commodo, nunc risus elementum magna, in euismod odio magna ut lectus.
            </p>
            <p>
            Sed convallis magna in purus consequat a posuere diam ullamcorper. Vestibulum id ante vel metus iaculis egestas. Pellentesque erat erat, gravida ut aliquet eu, dignissim ac mauris. Quisque magna odio, blandit ac cursus sed, feugiat tincidunt tellus. Maecenas mollis elit ac ipsum aliquam at rhoncus est ultricies. Morbi non ipsum vitae est pellentesque dignissim quis eu velit. In hac habitasse platea dictumst. 
            </p>
        </div>
        
        <div>
            <h1>Nam</h1>
            <p>
            Nam facilisis luctus sagittis. Fusce cursus ligula vitae nibh consequat feugiat. Praesent luctus urna cursus ligula malesuada iaculis. Ut nibh purus, tristique sed consectetur in, hendrerit sit amet lacus. In interdum pulvinar ipsum eu lobortis. Maecenas in lacus quis lacus blandit aliquam. Aenean non suscipit nisl. Sed nibh risus, interdum nec posuere eget, rutrum quis ipsum. Aliquam arcu est, eleifend feugiat rutrum eget, viverra non erat. Suspendisse suscipit pellentesque placerat.
            </p>
            <p>
            Donec vehicula auctor eleifend. Ut suscipit pretium ipsum, quis aliquam est tempor sed. Aliquam rutrum odio vitae turpis feugiat vestibulum. Duis fermentum pellentesque aliquam. Suspendisse eu lorem mauris. Aliquam sed justo in mauris porttitor ornare sit amet tristique mi. Quisque semper quam at nulla lobortis ut vulputate dui suscipit. Sed ac dui vel purus mattis sollicitudin quis eget leo. Maecenas vulputate, massa eu tristique viverra, lorem metus pulvinar orci, in aliquam nisi nisi a neque. Cras non ligula quis metus pretium dictum. 
            </p>
        </div>
    </div>
</div>
