{% extends "base.html" %}
{% load maintain_extras %}

{% block content %}

    <h1>{{wrapper.name}}
        {% if perms|has_perm:PERM_WRITE %}<a href="{{instance.id}}/Edit"><div class="button button_edit" title="edit"></div></a>{% endif %}
        {% if perms|has_perm:PERM_DELETE %}<div class="button button_delete" title="delete"></div>{% endif %}
    </h1>
    {% include "view/model_fields.html" %}
    
    {% if wrapper.parent %}
        {% for field, wrapper in wrapper.parent.items %}
            {% for field, wrapper in wrapper.one_to_many.items %}
                <h2 class="section list">{{wrapper.name}}</h2>
                {% if instance|get:field %}
                    {% with instance|get:field|f:'all' as instances %}
                        {% include "view/list_instances.html" %}
                    {% endwith %}
                {% endif %}
            {% endfor %}
        {% endfor %}
    {% endif %}
    
    {% for field, wrapper in wrapper.one_to_one.items %}
        <h2 class="section">{{wrapper.name}}</h2>
        {% with instance|get:field as instance %}
            {% include "view/model_fields.html" %}
        {% endwith %}
    {% endfor %}
        
    {% for field, wrapper in wrapper.one_to_many.items %}
        <h2 class="section list">{{wrapper.name}}</h2>
        {% if instance|get:field %}
            {% with instance|get:field|f:'all' as instances %}
                {% include "view/list_instances.html" %}
            {% endwith %}
        {% endif %}
    {% endfor %}


{% endblock %}